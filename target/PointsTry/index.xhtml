<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://xmlns.jcp.org/jsf/html">
<h:head>
    <title>Points</title>
    <link rel="stylesheet" type="text/css" href="css/style.css"/>
    <script src="js/script.js"></script>
    <style>
        body {
            background-image: url("./pics/aesthetic-anime-character-gaming.jpg");
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center center;
            color: white;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            z-index: 1;
            pointer-events: none;
        }

        body > * {
            position: relative;
            z-index: 2;
        }
    </style>
</h:head>
<h:body>
    <h:outputScript>
        var pointsFromDB = JSON.parse('#{helloBean.pointsJson}');
    </h:outputScript>

    <nav>
        <h:link value="Go to Clock" outcome="clock" />
        <h:form>
            <h:commandLink value="Clear Points" action="#{helloBean.clearPoints}" />
        </h:form>
    </nav>

    <h:form prependId="false" id="pointForm">
        <h:outputLabel value="Enter your X: " />
        <h:selectOneRadio id="xValue" value="#{helloBean.x}">
            <f:ajax execute="@this" render="hiddenXValue enteredX" />
            <f:selectItem itemValue="-7" itemLabel="-7" />
            <f:selectItem itemValue="-6" itemLabel="-6" />
            <f:selectItem itemValue="-5" itemLabel="-5" />
            <f:selectItem itemValue="-4" itemLabel="-4" />
            <f:selectItem itemValue="-3" itemLabel="-3" />
            <f:selectItem itemValue="-2" itemLabel="-2" />
            <f:selectItem itemValue="-1" itemLabel="-1" />
            <f:selectItem itemValue="0" itemLabel="0" />
            <f:selectItem itemValue="1" itemLabel="1" />
            <f:selectItem itemValue="2" itemLabel="2" />
            <f:selectItem itemValue="3" itemLabel="3" />
            <f:selectItem itemValue="4" itemLabel="4" />
            <f:selectItem itemValue="5" itemLabel="5" />
        </h:selectOneRadio>

        <h:inputHidden id="hiddenXValue" value="#{helloBean.x}" />

        <h:outputFormat id="enteredX" value="Entered X: #{helloBean.x}">
            <f:param value="#{helloBean.x}" />
        </h:outputFormat>
        <br />

        <h:outputLabel value="Enter your Y: " />
        <h:inputText id="yValue" value="#{helloBean.y}" />
        <br />

        <h:outputLabel value="Enter your R: " />
        <h:selectOneMenu value="#{helloBean.r}" id="rValue" onchange="draw();"
                         style="background-color: rgba(219, 184, 243, 0.65);
                                color: #FFFFFF">
            <f:ajax execute="@this" />
            <f:selectItem itemValue="1" itemLabel="1" />
            <f:selectItem itemValue="2" itemLabel="2" />
            <f:selectItem itemValue="3" itemLabel="3" />
            <f:selectItem itemValue="4" itemLabel="4" />
            <f:selectItem itemValue="5" itemLabel="5" />
            <f:selectItem itemValue="6" itemLabel="6" />
        </h:selectOneMenu>
        <br />

        <h:commandButton id="checkButton"
                         styleClass="roundBtn"
                         value="Check Point"
                         action="#{helloBean.checkPoint}"
                         onclick="return validateForm();" />
        <br />
    </h:form>

    <h:outputScript rendered="#{not empty helloBean.resultMessage}">
        document.addEventListener("DOMContentLoaded", function () {
            var msg = "#{helloBean.resultMessage}";
            if (msg === "Hit!") {
                showNotification(msg, "./pics/happy.gif");
            } else {
                showNotification(msg, "./pics/sad.gif");
            }
        });
    </h:outputScript>


    <div class="twoTablesContainer">
        <h:panelGrid styleClass="twoTables" columns="1" cellpaddings="1">
            <h:outputLabel><canvas id="graphCanvas" width="800" height="800" /></h:outputLabel>
        </h:panelGrid>

    <!--    <h3>Таблица точек</h3>-->
        <div class="twoTables" id="overflow" style="width: 70%;">
            <p:dataTable id="pointTable" style="width: 100%" value="#{helloBean.points}" var="point">
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="ID" />
                    </f:facet>
                    <h:outputText value="#{point.id}" />
                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="X" />
                    </f:facet>
                    <h:outputText value="#{point.x}" />
                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Y" />
                    </f:facet>
                    <h:outputText value="#{point.y}" />
                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="R" />
                    </f:facet>
                    <h:outputText value="#{point.r}" />
                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Current Time" />
                    </f:facet>
                    <h:outputText value="#{point.currentTime}" />
                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Execution Time" />
                    </f:facet>
                    <h:outputText value="#{point.executionTime}" />
                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="Result" />
                    </f:facet>
                    <h:outputText
                            value="#{point.resultMessage}"
                            style="#{point.resultMessage eq 'Hit!' ? 'color: rgb(23, 255, 0);' : 'color: red;'}" />
                </p:column>
            </p:dataTable>
        </div>
    </div>

    <div id="notification" class="notification" style="display: none;"></div>

</h:body>
</html>
